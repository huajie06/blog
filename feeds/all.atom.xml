<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Huajie's Notes</title><link href="/" rel="alternate"></link><link href="/feeds/all.atom.xml" rel="self"></link><id>/</id><updated>2020-01-10T00:00:00-05:00</updated><subtitle>A place where I keep some notes</subtitle><entry><title>Org Mode</title><link href="/posts/2020/01/10/org-mode/" rel="alternate"></link><published>2020-01-10T00:00:00-05:00</published><updated>2020-01-10T00:00:00-05:00</updated><author><name>huajie</name></author><id>tag:None,2020-01-10:/posts/2020/01/10/org-mode/</id><summary type="html">&lt;p&gt;org mode settings and common cmd&lt;/p&gt;</summary><content type="html">&lt;h1&gt;Some settings&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;infile options&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;#+todo: A B C | D E&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;#+startup: showall&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;#+author&lt;/code&gt; and etc.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Refresh the setting at top with &lt;code&gt;C-c C-c&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Keys&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;insert a header &lt;code&gt;C-Enter&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;insert a header with todo &lt;code&gt;S-C-Enter&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;toggle a header with todo &lt;code&gt;S-left/right&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;complete &lt;code&gt;M-tab&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;insert date/datetime &lt;code&gt;C-c .&lt;/code&gt;, and &lt;code&gt;C-u C-c .&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Some convention
    Paragraph alignment like this.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Markups
    Like following&lt;/p&gt;
&lt;p&gt;&lt;code&gt;example
*bold*, /italic/, _underlined_, =code= and ~verbatim~, and, if you must, +strike-through+.&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Add a tag
    Use &lt;code&gt;C-c C-c&lt;/code&gt; when are a header
    Say if the TAGS are the following, can use hotkeys to pick
    &lt;code&gt;#+TAGS: COMPUTER(c) PHONE(p) READING(r)&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Planning&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;insert a schedule at &lt;strong&gt;current&lt;/strong&gt; item &lt;code&gt;C-c C-s&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;insert a deadlin at &lt;strong&gt;current&lt;/strong&gt; item &lt;code&gt;C-c C-d&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;org-agenda to list all items&lt;ul&gt;
&lt;li&gt;in order to display need to have &lt;strong&gt;todo&lt;/strong&gt; and &lt;strong&gt;time items&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;Code block&lt;/h1&gt;
&lt;p&gt;Use &lt;code&gt;org-display-inline-images&lt;/code&gt; to display the image&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;#+BEGIN_SRC python :results output&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;version&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;#+END_SRC&lt;/span&gt;

&lt;span class="c1"&gt;#+RESULTS:&lt;/span&gt;
&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;3.8&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;v3&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;8.0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;fa919fdf25&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Oct&lt;/span&gt; &lt;span class="mi"&gt;14&lt;/span&gt; &lt;span class="mi"&gt;2019&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;23&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;27&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; 
&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;Clang&lt;/span&gt; &lt;span class="mf"&gt;6.0&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clang&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;600.0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;57&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;

&lt;span class="c1"&gt;#+begin_src python :results file&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt;
&lt;span class="n"&gt;matplotlib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;use&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Agg&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="kn"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;figure&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;figsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;linspace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;plot&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;numpy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sin&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tight_layout&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;savefig&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;python-matplot-fig.png&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;python-matplot-fig.png&amp;#39;&lt;/span&gt; &lt;span class="c1"&gt;# return filename to org-mode&lt;/span&gt;
&lt;span class="c1"&gt;#+end_src&lt;/span&gt;

&lt;span class="c1"&gt;#+RESULTS:&lt;/span&gt;
&lt;span class="p"&gt;[[&lt;/span&gt;&lt;span class="nb"&gt;file&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;python&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;matplot&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;fig&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;png&lt;/span&gt;&lt;span class="p"&gt;]]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h1&gt;todo items&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;sparse tree &lt;code&gt;C-c /&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;</content><category term="emacs"></category><category term="org-mode"></category></entry><entry><title>Python News Scraping Notes</title><link href="/posts/2019/12/26/python-news-scraping/" rel="alternate"></link><published>2019-12-26T00:00:00-05:00</published><updated>2019-12-26T00:00:00-05:00</updated><author><name>huajie</name></author><id>tag:None,2019-12-26:/posts/2019/12/26/python-news-scraping/</id><summary type="html">&lt;p&gt;The intention of this site was really for myself to have a place to scan a collection of news quickly. &lt;/p&gt;
&lt;p&gt;The goal was to use Python to &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Request a news website xml/html feed &lt;/li&gt;
&lt;li&gt;Parse it using some library, keep the wanted info&lt;/li&gt;
&lt;li&gt;Store it to database&lt;/li&gt;
&lt;li&gt;Dashboarding&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Collection of â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;The intention of this site was really for myself to have a place to scan a collection of news quickly. &lt;/p&gt;
&lt;p&gt;The goal was to use Python to &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Request a news website xml/html feed &lt;/li&gt;
&lt;li&gt;Parse it using some library, keep the wanted info&lt;/li&gt;
&lt;li&gt;Store it to database&lt;/li&gt;
&lt;li&gt;Dashboarding&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Collection of news source&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;CNBC&lt;/li&gt;
&lt;li&gt;Bloomberge, &lt;strong&gt;subscription needed&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Yahoo&lt;/li&gt;
&lt;li&gt;WSJ, &lt;strong&gt;subscription needed&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;~~Reuters~~&lt;/li&gt;
&lt;li&gt;MarketWatch&lt;/li&gt;
&lt;li&gt;Google Search with &lt;strong&gt;China&lt;/strong&gt; as a key words&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The script will runs every 10 min and there's a random number generator to determine if the code gets executed within each source block.&lt;/p&gt;
&lt;p&gt;The notes area use Javascript &lt;a href="https://github.com/showdownjs/showdown"&gt;Showdown&lt;/a&gt; to convert markdown into HTML rendering. &lt;/p&gt;
&lt;h3&gt;TODO&lt;/h3&gt;
&lt;p&gt;Replace Python with Javascript to scrape the website&lt;/p&gt;
&lt;p&gt;Parse the title and the content to 
    - get the topic
    - some kind of sentiment&lt;/p&gt;</content><category term="Web"></category><category term="python"></category><category term="flask"></category></entry><entry><title>Deploy flask app on Raspberry pi</title><link href="/posts/2019/12/25/flask-deployment/" rel="alternate"></link><published>2019-12-25T00:00:00-05:00</published><updated>2019-12-25T00:00:00-05:00</updated><author><name>huajie</name></author><id>tag:None,2019-12-25:/posts/2019/12/25/flask-deployment/</id><summary type="html">&lt;p&gt;Flask deployment&lt;/p&gt;</summary><content type="html">&lt;p&gt;Some options didn't try to remember&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# listen to all port&lt;/span&gt;
flask run --host&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0.0.0
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Same as above&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;0.0.0.0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;debug&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;SSH setup&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;vim /etc/ssh/sshd_config
&lt;span class="c1"&gt;# 1. Disable root login by &lt;/span&gt;
&lt;span class="c1"&gt;#     - PermitRootLogin no&lt;/span&gt;
&lt;span class="c1"&gt;# 2. Disable password logins&lt;/span&gt;
&lt;span class="c1"&gt;#     - PasswordAuthentication no&lt;/span&gt;
sudo service ssh restart
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Install ufw - uncomplicated fire wall&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo apt-get install ufw
sudo ufw allow ssh
sudo ufw allow http
sudo ufw allow &lt;span class="m"&gt;443&lt;/span&gt;/tcp
sudo ufw --force &lt;span class="nb"&gt;enable&lt;/span&gt;
sudo ufw status
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Install nginx and supervisor&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo apt-get install
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Also gunicorn using pip under virtual env&lt;/p&gt;
&lt;p&gt;Get a secret key by &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;python3 -c &lt;span class="s2"&gt;&amp;quot;import uuid; print(uuid.uuid4().hex)&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Setting up gunicorn and supervisor. This command needs to be inside of &lt;strong&gt;your app&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# number of workers = core/2 + 1&lt;/span&gt;
gunicorn -b localhost:8000 -w &lt;span class="m"&gt;4&lt;/span&gt; blog:app
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Set up nginx
1. Delete the file sudo rm /etc/nginx/sites-enabled/default
2. Create a new one, &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;server_name&lt;/strong&gt; can be your domain name&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;server &lt;span class="o"&gt;{&lt;/span&gt;
        listen &lt;span class="m"&gt;80&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        server_name &lt;span class="m"&gt;192&lt;/span&gt;.168.1.117&lt;span class="p"&gt;;&lt;/span&gt;

        location /static &lt;span class="o"&gt;{&lt;/span&gt;
                &lt;span class="nb"&gt;alias&lt;/span&gt; /home/pi/py/fin_news/static&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;

        location / &lt;span class="o"&gt;{&lt;/span&gt;
                proxy_pass http://localhost:8000&lt;span class="p"&gt;;&lt;/span&gt;
                include /etc/nginx/proxy_params&lt;span class="p"&gt;;&lt;/span&gt;
                proxy_redirect off&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Install supervisor and setup.
Add this to &lt;strong&gt;/etc/supervisor/conf.d/flask-blog.conf&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;program:flaskblog&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="nv"&gt;directory&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/home/pi/py/fin_news
&lt;span class="nv"&gt;command&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/home/pi/py/fin_news/venv/bin/gunicorn -b localhost:8000 -w &lt;span class="m"&gt;4&lt;/span&gt; blog:app
&lt;span class="nv"&gt;user&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;pi
&lt;span class="nv"&gt;autostart&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;true&lt;/span&gt;
&lt;span class="nv"&gt;autorestart&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;true&lt;/span&gt;
&lt;span class="nv"&gt;stopasgroup&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;true&lt;/span&gt;
&lt;span class="nv"&gt;killasgroup&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;true&lt;/span&gt;
&lt;span class="nv"&gt;stderr_logfile&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/home/pi/py/fin_news/log/flaskblog.err.log
&lt;span class="nv"&gt;stdout_logfile&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/home/pi/py/fin_news/log/flaskblog.out.log
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;You have to start supervisord before you can use supervisorctl, which is to run the following&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo supervisord -c /etc/supervisor/supervisord.conf
sudo supervisorctl -c /etc/supervisor/supervisord.conf
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Then finally run &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# supervisord start flaskblog&lt;/span&gt;
sudo supervisorctl restart flaskblog
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Add SSL&lt;/p&gt;
&lt;p&gt;First need to open the firewall on linux server as well as router if home hosting&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo ufw allow https
sudo ufw status
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Run the cmd from letsencrypt&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;wget https://dl.eff.org/certbot-auto
sudo mv certbot-auto /usr/local/bin/certbot-auto
sudo chown root /usr/local/bin/certbot-auto
sudo chmod &lt;span class="m"&gt;0755&lt;/span&gt; /usr/local/bin/certbot-auto
&lt;span class="c1"&gt;#then do this &lt;/span&gt;
sudo /usr/local/bin/certbot-auto --nginx
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Each time once the setup file change, refresh with the following&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo systemctl restart nginx
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Renew &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;/usr/local/bin/certbot-auto renew
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Some cmd used&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ls -l --block-size&lt;span class="o"&gt;=&lt;/span&gt;MB
ls -l --block-size&lt;span class="o"&gt;=&lt;/span&gt;M
ls -lh
sudo vim /etc/nginx/sites-enabled/flask-blog
tail -n &lt;span class="m"&gt;20&lt;/span&gt; /var/log/nginx/error.log
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Now the nginx file becomes&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nt"&gt;server&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="err"&gt;server_name&lt;/span&gt; &lt;span class="err"&gt;www.huajiezhang.com&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

        &lt;span class="err"&gt;location&lt;/span&gt; &lt;span class="err"&gt;/static&lt;/span&gt; &lt;span class="err"&gt;{&lt;/span&gt;
                &lt;span class="err"&gt;alias&lt;/span&gt; &lt;span class="err"&gt;/home/pi/py/fin_news/static&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
        &lt;span class="nt"&gt;location&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="err"&gt;proxy_pass&lt;/span&gt; &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="n"&gt;localhost&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;8000&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="err"&gt;include&lt;/span&gt; &lt;span class="err"&gt;/etc/nginx/proxy_params&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
                &lt;span class="err"&gt;proxy_redirect&lt;/span&gt; &lt;span class="err"&gt;off&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="nt"&gt;listen&lt;/span&gt; &lt;span class="nt"&gt;443&lt;/span&gt; &lt;span class="nt"&gt;ssl&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;managed&lt;/span&gt; &lt;span class="nt"&gt;by&lt;/span&gt; &lt;span class="nt"&gt;Certbot&lt;/span&gt;
    &lt;span class="nt"&gt;ssl_certificate&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;letsencrypt&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;live&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;www&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;huajiezhang&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;com&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;fullchain&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;pem&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;managed&lt;/span&gt; &lt;span class="nt"&gt;by&lt;/span&gt; &lt;span class="nt"&gt;Certbot&lt;/span&gt;
    &lt;span class="nt"&gt;ssl_certificate_key&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;letsencrypt&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;live&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;www&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;huajiezhang&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;com&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;privkey&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;pem&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;managed&lt;/span&gt; &lt;span class="nt"&gt;by&lt;/span&gt; &lt;span class="nt"&gt;Certbot&lt;/span&gt;
    &lt;span class="nt"&gt;include&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;letsencrypt&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;options-ssl-nginx&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;conf&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;managed&lt;/span&gt; &lt;span class="nt"&gt;by&lt;/span&gt; &lt;span class="nt"&gt;Certbot&lt;/span&gt;
    &lt;span class="nt"&gt;ssl_dhparam&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;letsencrypt&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;ssl-dhparams&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;pem&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;managed&lt;/span&gt; &lt;span class="nt"&gt;by&lt;/span&gt; &lt;span class="nt"&gt;Certbot&lt;/span&gt;
&lt;span class="err"&gt;}&lt;/span&gt;

&lt;span class="nt"&gt;server&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="err"&gt;if&lt;/span&gt; &lt;span class="err"&gt;($host&lt;/span&gt; &lt;span class="err"&gt;=&lt;/span&gt; &lt;span class="err"&gt;www.huajiezhang.com)&lt;/span&gt; &lt;span class="err"&gt;{&lt;/span&gt;
        &lt;span class="err"&gt;return&lt;/span&gt; &lt;span class="err"&gt;301&lt;/span&gt; &lt;span class="n"&gt;https&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="n"&gt;request_uri&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;managed&lt;/span&gt; &lt;span class="nt"&gt;by&lt;/span&gt; &lt;span class="nt"&gt;Certbot&lt;/span&gt;
        &lt;span class="nt"&gt;listen&lt;/span&gt; &lt;span class="nt"&gt;80&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
        &lt;span class="nt"&gt;server_name&lt;/span&gt; &lt;span class="nt"&gt;www&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;huajiezhang&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;com&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;
    &lt;span class="nt"&gt;return&lt;/span&gt; &lt;span class="nt"&gt;404&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt; &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="nt"&gt;managed&lt;/span&gt; &lt;span class="nt"&gt;by&lt;/span&gt; &lt;span class="nt"&gt;Certbot&lt;/span&gt;
&lt;span class="err"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;TODO&lt;/h3&gt;
&lt;p&gt;redirect to non www site - huajiezhang.com&lt;/p&gt;</content><category term="Web"></category><category term="flask"></category><category term="python"></category></entry></feed>